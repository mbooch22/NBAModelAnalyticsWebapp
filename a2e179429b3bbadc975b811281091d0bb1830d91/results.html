<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <style>
        .loader {
            position: fixed;
            z-index: 999;
            height: 2em;
            width: 2em;
            overflow: visible;
            margin: auto;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            /* Safari */
            animation: spin 2s linear infinite;
        }

        /* Safari */
        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .overlay {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9);
            overflow-x: hidden;
            /*transition: 0.5s;*/
        }

        .overlay-content {
            position: relative;
            top: 0%;
            width: 100%;
            text-align: center;
            margin-top: 0px;
        }

        .overlay a {
            padding: 8px;
            text-decoration: none;
            font-size: 36px;
            color: #818181;
            display: block;
            /*transition: 0.3s;*/
        }

        .overlay a:hover,
        .overlay a:focus {
            color: #f1f1f1;
        }

        .overlay .closebtn {
            position: absolute;
            top: 20px;
            right: 45px;
            font-size: 60px;
        }

        @media screen and (max-height: 450px) {
            .overlay a {
                font-size: 20px
            }

            .overlay .closebtn {
                font-size: 40px;
                top: 15px;
                right: 35px;
            }
        }

        @media screen and (max-width: 700px) {
            .box {
                width: 70%;
            }

            .popup {
                width: 70%;
            }
        }


        .popupOverlay {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            transition: opacity 500ms;
            visibility: hidden;
            opacity: 0;
        }

        .popupOverlay:target {
            visibility: visible;
            opacity: 1;
        }

        .popup {
            margin: 70px auto;
            padding: 20px;
            background: #261c3e;
            border-radius: 5px;
            /*width: 30%;*/
            position: relative;
            transition: all 5s ease-in-out;
        }

        .popup h2 {
            margin-top: 0;
            color: #333;
            font-family: Tahoma, Arial, sans-serif;
        }

        .popup .close {
            position: absolute;
            top: 20px;
            right: 30px;
            transition: all 200ms;
            font-size: 30px;
            font-weight: bold;
            text-decoration: none;
            color: rgb(255, 254, 254);
        }

        .popup .close:hover {
            color: #06D85F;
        }

        .popup .content {
            /*max-height: 30%;*/
            overflow: auto;
        }
    </style>

    <title>Results</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css" />
    </noscript>
</head>

<body class="is-preload">
    <div class="loader"></div>
    <!-- Header -->
    <header id="header">
        <a href="index.html" class="title">NBA Predictive Analysis</a>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="webscraping.html">Web Scraping</a></li>
                <li><a href="machineLearning.html">Machine Learning</a></li>
                <li><a href="objectives.html">Objectives</a></li>
                <li><a href="objectives.html" class="active">Results</a></li>
                <li><a href="elements.html">Add Later</a></li>
            </ul>
        </nav>
    </header>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Main -->
        <section id="main" class="wrapper">
            <div class="inner">
                <h1 class="major">NBA ML Prediction Results</h1>
                <ul class="actions fit">
                    <li><a id="showFilterButton" class="button fit">Show Filters</a></li>
                    <li><a id="filterButton" class="button fit">Filter Data</a></li>
                </ul>
                <br>
                <div id="filters" class="row gtr-uniform">
                    <div class="col-6 col-12-xsmall">
                        <label for="startDate">Start Date</label>
                        <input type="date" id="startDate" name="startDate" min="2021-02-25">
                    </div>
                    <div class="col-6 col-12-xsmall">
                        <label for="endDate">End Date</label>
                        <input type="date" id="endDate" name="endDate" min="2021-02-25">
                    </div>
                    <div class="col-6 col-12-xsmall">
                        <label for="model-version">Model Versions</label>
                        <select name="model-version" id="model-version">
                            <option value="">- Model Version -</option>
                            <option value="1">Version 1 - Spread Only</option>
                            <option value="Spread2, Total1-1">Version 2 - Spread and Total Only</option>
                            <option value="2W_2">Version 3 - Latest</option>
                        </select>
                    </div>
                    <div class="col-12 col-12-small">
                        <label for="prediction-type">Prediction Type (Bet Type)</label>
                        <div>
                            <input type="checkbox" id="margin" name="margin">
                            <label for="margin">Point Differential - Game Spread</label>
                            <input type="checkbox" id="total" name="total">
                            <label for="total">Game Total - Over/Under</label>
                            <input type="checkbox" id="win" name="win">
                            <label for="win">Win Percentage - Money Line</label>
                            <input type="checkbox" id="home" name="home">
                            <label for="home">Home Team Score - Over/Under</label>
                            <input type="checkbox" id="away" name="away">
                            <label for="away">Away Team Score - Over/Under</label>
                        </div>
                    </div>
                    <div>
                        <label>Thresholds:</label>
                        <div class="col-4 col-12-small">
                            <input type="radio" id="no-threshold" value="" name="threshold" checked>
                            <label for="no-threshold">None</label>
                        </div>
                        <div class="col-4 col-12-small">
                            <input type="radio" id="threshold-1" value="Threshold1" name="threshold">
                            <label for="threshold-1">Threshold 1 Predictions</label>
                        </div>
                        <div class="col-4 col-12-small">
                            <input type="radio" id="threshold-2" value="Threshold2" name="threshold">
                            <label for="threshold-2">Threshold 2 Predictions</label>
                        </div>
                        <div class="col-4 col-12-small">
                            <input type="radio" id="threshold-3" value="Threshold3" name="threshold">
                            <label for="threshold-3">Threshold 3 Predictions</label>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="wrapper">
            <div class="inner">
                <div class="features">
                    <section>
                        <span class="icon solid major fa-chart-line"></span>
                        <h3>Profit</h3>
                        <div id="lineChartContainer" style="height: 300px; width: 100%;"></div>
                        <br>
                        <div class="col-6 col-12-xsmall">
                            <a id="expandLineGraph" class="button fit">More</a>
                        </div>
                    </section>
                    <section>
                        <span class="icon solid major fa-chart-bar"></span>
                        <h3>Game Bets By Date (latest)</h3>
                        <div class="table-wrapper">
                            <table id="betDropDownTable" class="alt">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-6 col-12-xsmall">
                            <a id="expandGameDropDowns" class="button fit">See All Dates</a>
                        </div>
                    </section>
                    <section>
                        <span class="icon solid major fa-chart-pie"></span>
                        <h3>Win Percentage</h3>
                        <div id="chartContainer" style="height: 300px; width: 100%;"></div>
                        <br>
                        <div class="col-6 col-12-xsmall">
                            <a id="expandWinningPercentage" class="button fit">More</a>
                        </div>
                    </section>
                    <section>
                        <span class="icon solid major fa-table"></span>
                        <h3>Raw Data</h3>
                        <div class="col-6 col-12-xsmall">
                            <a id="showRawDataButton" class="button fit">Show Raw Data</a>
                        </div>
                    </section>
                </div>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer id="footer" class="wrapper alt">
        <div class="inner">
            <ul class="menu">
                <li>&copy; MB13. All rights reserved.</li>
            </ul>
        </div>
    </footer>
    <!-- Popups -->
    <div id="rawDataPopup" class="overlay" style="width: 100%; display: none;">
        <div class="overlay-content">
            <h2>Raw Data Table</h2>
            <div style="text-align: end;">
                <a class="closebtn" style="position: inherit !important;" href="#">&times;</a>
            </div>
            <div class="table-wrapper">
                <table id="rawDataTable" class="alt">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Home Team</th>
                            <th>Away Team</th>
                            <th>Name</th>
                            <th>Home Score</th>
                            <th>Vegas Home</th>
                            <th>Home Score Bet on</th>
                            <th>BET HOME</th>
                            <th>THRESHOLD_HOME</th>
                            <th>Away Score</th>
                            <th>Vegas Away</th>
                            <th>Away Score Bet On</th>
                            <th>BET AWAY</th>
                            <th>Threshold_AWAY</th>
                            <th>Winner</th>
                            <th>Vegas MoneyLine Odds</th>
                            <th>ML bet on</th>
                            <th>BET WIN</th>
                            <th>Threshold_ML</th>
                            <th>Game Margin</th>
                            <th>Vegas Odds</th>
                            <th>Team Bet On</th>
                            <th>BET SPREAD</th>
                            <th>Threshold_SPREAD</th>
                            <th>Total Points</th>
                            <th>Vegas Over/Under</th>
                            <th>Total Bet On</th>
                            <th>BET TOTAL</th>
                            <th>Threshold_TOTAL</th>
                            <th>Model Version</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="2"></td>
                            <td>100.00</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
    <div id="winningPercentagePopup" style="width: 100%; display: none;" class="overlay">
        <div class="overlay-content">
            <div style="text-align: end;">
                <a class="closebtn" style="position: inherit !important;" href="#">&times;</a>
            </div>
            <div class="inner">
                <div class="features">
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerMain"></div>
                    </section>
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerMargin"></div>
                    </section>
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerTotal"></div>
                    </section>
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerHome"></div>
                    </section>
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerAway"></div>
                    </section>
                    <section>
                        <div style="height: 300px; width: 100%;" id="chartContainerWinner"></div>
                    </section>
                </div>
            </div>
        </div>
    </div>
    <div id="betByDatePopover" class="overlay" style="width: 100%; display: none;">
        <div class="overlay-content">
            <h2>Bet Results by Date</h2>
            <div style="text-align: end;">
                <a class="closebtn" style="position: inherit !important;" href="#">&times;</a>
            </div>
            <div class="table-wrapper">
                <table id="betDropDownPopoverTable" class="alt">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script type="text/javascript" src="data.js"></script>
    <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#filters").hide();
            $("#filterButton").click(function () {
                window.nbaData = getData();
                var data = filterData(window.nbaData);
                setTable(data);
                setChart(data, "chartContainer", false, "Winning Percentage");
                setDropDownTable("betDropDownTable", data, false);
            });
            $("#showFilterButton").click(function () {
                if ($("#filters").is(":visible")) {
                    $("#filters").hide();
                    $("#showFilterButton").text("Show Filters")
                } else {
                    $("#filters").show();
                    $("#showFilterButton").text("Hide Filters")
                }

            });

            $("#expandWinningPercentage").click(function (e) {
                //document.getElementById("winningPercentagePopup").style.width = "100%";   
                $("#winningPercentagePopup").slideDown(1000);
                window.nbaData = getData();
                const data = filterData(window.nbaData);
                //setTable(data);
                setChart(data, "chartContainerMain", true, "Overall Winning Percentage");

                var tempData = filterBetType(filterData(getData()), "margin");
                setChart(tempData, "chartContainerMargin", true, "Spread Bet Percentage");

                tempData = filterBetType(filterData(getData()), "total");
                setChart(tempData, "chartContainerTotal", true, "Over/Under Bet Percentage");

                tempData = filterBetType(filterData(getData()), "home");
                setChart(tempData, "chartContainerHome", true, "Home Total O/U Bet Percentage");

                tempData = filterBetType(filterData(getData()), "away");
                setChart(tempData, "chartContainerAway", true, "Away Total O/U Bet Percentage");

                tempData = filterBetType(filterData(getData()), "win");
                setChart(tempData, "chartContainerWinner", true, "Moneyline Bet Percentage");


            });

            $("#expandGameDropDowns").click(function (e) {
                $("#betDropDownTable tbody").empty();
                $("#betByDatePopover").slideDown(1000);
                setDropDownTable("betDropDownPopoverTable", filterData(getData()), true);
            });

            $(".closebtn").click(function (e) {
                //document.getElementById("winningPercentagePopup").style.width = "0%"; 
                $("#winningPercentagePopup").slideUp("fast");
                $("#rawDataPopup").slideUp("fast");
                $("#betByDatePopover").slideUp("fast");
                $("#betByDatePopover tbody").empty();

                setDropDownTable("betDropDownTable", filterData(getData()), false);
            });

            $("#showRawDataButton").click(function (e) {
                $("#rawDataPopup").slideDown(1000);
            });

            setDropDownTable("betDropDownTable", filterData(getData()), false);
        });

        function setDropDownTable(id, data, expanded) {
            $("#" + id + " tbody").empty();
            $("#" + id + " tfooter").empty();
            var uniqueDates = $.unique(data.map(function (d) { return d.Date.substring(0, 10); }));
            uniqueDates.sort((a, b) => new Date(b) - new Date(a));
            //set Dates
            if (expanded) {
                uniqueDates.forEach(function (date, i) {
                    var row = $('<tr id="' + date + '"/>');
                    var button = $('<a id="' + date + '" onclick="toggleDateDropDown(this.id)"" class="button fa fa-chevron-down"></a>');
                    row.append(button);
                    if (new Date(date).toLocaleDateString("en-US") !== "Invalid Date") {
                        row.append($('<td/>').html(new Date(date).toLocaleDateString("en-US")));
                        $("#" + id).append(row);
                        var betsResults = getBetsWon(data, date);
                        var footer = $('<tr> <td colspan="1"></td> <td>Wins: ' + betsResults[0] +
                            ' Losses: ' + betsResults[1] + '</td> </tr>')
                        $("#" + id).append(footer);
                    }

                });
            } else {
                if (new Date(uniqueDates[0]).toLocaleDateString("en-US") !== "Invalid Date") {
                    var row = $('<tr id="' + uniqueDates[0] + '"/>');
                    var button = $('<a id="' + uniqueDates[0] + '" onclick="toggleDateDropDown(this.id)"" class="button fa fa-chevron-down"></a>');
                    row.append(button);
                    row.append($('<td/>').html(new Date(uniqueDates[0]).toLocaleDateString("en-US")));
                    var betsResults = getBetsWon(data, uniqueDates[0]);
                    var footer = $('<tr> <td colspan="1"></td> <td>Wins: ' + betsResults[0] +
                        ' Losses: ' + betsResults[1] + '</td> </tr>')
                    $("#" + id).append(row);
                    $("#" + id).append(footer);
                }
            }


        }


        function getBetsWon(data, date) {
            var wins = 0;
            var losses = 0;
            for (var i = 0; i < data.length; i++) {
                if (data[i]["Date"].substring(0, 10) == date) {
                    if (data[i]["BET SPREAD"] == "W") {
                        wins++;
                    } else if (data[i]["BET SPREAD"] == "L") {
                        losses++;
                    }
                    if (data[i]["BET TOTAL"] == "W") {
                        wins++;
                    } else if (data[i]["BET TOTAL"] == "L") {
                        losses++;
                    }
                    if (data[i]["BET HOME"] == "W") {
                        wins++;
                    } else if (data[i]["BET HOME"] == "L") {
                        losses++;
                    }
                    if (data[i]["BET AWAY"] == "W") {
                        wins++;
                    } else if (data[i]["BET AWAY"] == "L") {
                        losses++;
                    }
                    if (data[i]["BET WIN"] == "W") {
                        wins++;
                    } else if (data[i]["BET WIN"] == "L") {
                        losses++;
                    }
                }
            }
            return [wins, losses];
        }

        function toggleDateDropDown(id) {
            if ($("#" + id + " a").first().attr('class') === "button fa fa-chevron-up") {
                //hide
                $("#" + id + " a").first().removeClass('fa-chevron-up').addClass('fa-chevron-down');
                $("#" + id + " td").first().children().hide();
            } else {
                $("#" + id + " a").first().removeClass('fa-chevron-down').addClass('fa-chevron-up');
                if ($("#" + id + " td").first().data()[0]) {
                    $("#" + id + " td").first().children().show()
                } else {
                    var label = $(' <tr> <th>Game</th></tr>')
                    $("#" + id + " td").first().append(label);
                    var data = filterData(getData());
                    var games = data.filter(game => game.Date.substring(0, 10) == id);
                    $("#" + id + " td").first().data(games);
                    games.forEach(function (game, i) {
                        var row = $('<tr id="' + game.Name.replaceAll(" ", "").replace("@", "at") + '" />');
                        var button = $('<a id="' + game.Name.replaceAll(" ", "").replace("@", "at") + '" onclick="toggleGameDropDown(this.id)"" class="button fa fa-chevron-down"></a>');
                        row.append(button);
                        row.append($('<td/>').html(game.Name));
                        $("#" + id + " td").first().append(row);
                    });
                }
            }
        }

        function toggleGameDropDown(id) {
            if ($("#" + id + " a").first().attr('class') === "button fa fa-chevron-up") {
                //hide
                $("#" + id + " a").first().removeClass('fa-chevron-up').addClass('fa-chevron-down');
                $("#" + id + " td").first().children().hide();
            } else {
                $("#" + id + " a").first().removeClass('fa-chevron-down').addClass('fa-chevron-up');
                if ($("#" + id + " td").first().children().length > 0) {
                    $("#" + id + " td").first().children().show()
                } else {
                    var label = $(' <tr> <th>Bets</th></tr>')
                    $("#" + id + " td").first().append(label);
                    var bets = ["Home O/U", "Away O/U", "Moneyline", "Spread", "Total O/U"];
                    var betMap = ["BET HOME", "BET AWAY", "BET WIN", "BET SPREAD", "BET TOTAL"]
                    var data = filterData(getData());
                    var games = data.filter(game => game.Date.substring(0, 10) == $("#" + id + " td").parent().parent().parent().attr("id") && game.Name.replaceAll(" ", "").replace("@", "at") == id);
                    for (var i = 0; i < bets.length; i++) {
                        if (games[0][betMap[i]]) {
                            var row = $('<tr id="' + id + bets[i].replaceAll(" ", "").replace("/", "") + '" />');
                            var button = $('<a id="' + id + bets[i].replaceAll(" ", "").replace("/", "") + '" onclick="toggleBetTypeDropDown(this.id)"" class="button fa fa-chevron-down"></a>');
                            row.append(button);
                            row.append($('<td/>').html(bets[i]));
                            $("#" + id + " td").first().append(row);
                        }
                    }
                }
            }
        }

        function toggleBetTypeDropDown(id) {
            if ($("#" + id + " a").first().attr('class') === "button fa fa-chevron-up") {
                //hide
                $("#" + id + " a").first().removeClass('fa-chevron-up').addClass('fa-chevron-down');
                $("#" + id + " td").first().children().hide();
            } else {
                $("#" + id + " a").first().removeClass('fa-chevron-down').addClass('fa-chevron-up');
                if ($("#" + id + " td").first().children().length > 0) {
                    $("#" + id + " td").first().children().show()
                } else {
                    var data = $("#" + id + " td").parent().parent().parent().parent().data();
                    var dataSize = Object.keys(data).length;
                    for (var i = 0; i < dataSize; i++) {
                        var tempID = $("#" + id + " td").parent().parent().parent().attr('id');
                        if (data[i].Name.replaceAll(" ", "").replace("@", "at") == tempID) {
                            var currData = data[i];
                        }
                    }
                    if (id.includes('HomeOU')) {
                        var label = $(' <tr> <th>Home Team</th> <th>Home Score</th> <th>Home Vegas Over Under</th> <th>Home Score Bet on</th> <th>Win/Loss</th> </tr>')
                        $("#" + id + " td").first().append(label);
                        var row = $('<tr/>');
                        row.append($('<td/>').html(currData["Home Team"]));
                        row.append($('<td/>').html(currData["Home Score"]));
                        row.append($('<td/>').html(currData["Vegas Home"]));
                        row.append($('<td/>').html(currData["Home Score Bet on"]));
                        row.append($('<td/>').html(currData["BET HOME"]));
                        $("#" + id + " td").first().append(row);
                    } else if (id.includes('AwayOU')) {
                        var label = $(' <tr> <th>Away Team</th> <th>Away Score</th> <th>Away Vegas Over Under</th> <th>Away Score Bet on</th> <th>Win/Loss</th> </tr>')
                        $("#" + id + " td").first().append(label);
                        var row = $('<tr/>');
                        row.append($('<td/>').html(currData["Away Team"]));
                        row.append($('<td/>').html(currData["Away Score"]));
                        row.append($('<td/>').html(currData["Vegas Away"]));
                        row.append($('<td/>').html(currData["Away Score Bet On"]));
                        row.append($('<td/>').html(currData["BET AWAY"]));
                        $("#" + id + " td").first().append(row);
                    } else if (id.includes('Moneyline')) {
                        var label = $(' <tr> <th>Home Team</th> <th>Vegas MoneyLine Odds</th> <th>Odds Bet On</th> <th>Winner</th> <th>Win/Loss</th> </tr>')
                        $("#" + id + " td").first().append(label);
                        var row = $('<tr/>');
                        row.append($('<td/>').html(currData["Home Team"]));
                        row.append($('<td/>').html(currData["Vegas MoneyLine Odds"]));
                        row.append($('<td/>').html(currData["ML bet on "]));
                        if (currData["Winner"] == "H") {
                            row.append($('<td/>').html(currData["Home Team"]));
                        } else {
                            row.append($('<td/>').html(currData["Away Team"]));
                        }
                        row.append($('<td/>').html(currData["BET WIN"]));
                        $("#" + id + " td").first().append(row);
                    } else if (id.includes('Spread')) {
                        var label = $(' <tr> <th>Home Team</th> <th>Vegas Odds</th> <th>Spread Bet On</th> <th>Final Game Margin</th> <th>Win/Loss</th> </tr>')
                        $("#" + id + " td").first().append(label);
                        var row = $('<tr/>');
                        row.append($('<td/>').html(currData["Home Team"]));
                        row.append($('<td/>').html(currData["Vegas Odds"]));
                        row.append($('<td/>').html(currData["Team Bet On"]));
                        row.append($('<td/>').html(currData["Game Margin"]));
                        row.append($('<td/>').html(currData["BET SPREAD"]));
                        $("#" + id + " td").first().append(row);
                    } else if (id.includes('TotalOU')) {
                        var label = $(' <tr> <th>Vegas Total Over Under</th> <th>Game Total Points</th> <th>Total Bet On</th> <th>Win/Loss</th> </tr>')
                        $("#" + id + " td").first().append(label);
                        var row = $('<tr/>');
                        row.append($('<td/>').html(currData["Vegas Over/Under"]));
                        row.append($('<td/>').html(currData["Total Points"]));
                        row.append($('<td/>').html(currData["Total Bet On"]));
                        row.append($('<td/>').html(currData["BET TOTAL"]));
                        $("#" + id + " td").first().append(row);
                    }

                }
            }
        }


        function setTable(data) {
            $("#rawDataTable tbody").empty();
            var columns = getColumns();
            for (var i = 0; i < data.length; i++) {
                var row = $('<tr/>');
                for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                    var val = data[i][columns[colIndex]];
                    // If there is any key, which is matching
                    // with the column name
                    if (val == null) {
                        val = "";
                    }
                    row.append($('<td/>').html(val));
                }
                // Adding each row to the table
                $("#rawDataTable").append(row);
            }
        }

        function filterData(data) {
            //get filter values
            var startDate = $("#startDate").val();
            var endDate = $("#endDate").val()
            var version = $("#model-version").val()
            var margin = $("#margin").is(":checked")
            var total = $("#total").is(":checked")
            var home = $("#home").is(":checked")
            var away = $("#away").is(":checked")
            var win = $("#win").is(":checked")
            var threshold = $("input[name=threshold]:checked").val()
            var filteredData = data;
            //filter Dates and version
            if (startDate) {
                filteredData = filteredData.filter(function (value, i) {
                    if ((new Date(startDate) <= new Date(value["Date"]))) {
                        return true;
                    }
                    else {
                        return false;
                    }
                });
            }
            if (endDate) {
                filteredData = filteredData.filter(function (value, i) {
                    if ((new Date(endDate) >= new Date(value["Date"]))) {
                        return true;
                    } else {
                        return false;
                    }
                });
            }
            if (version) {
                filteredData = filteredData.filter(function (value, i) {
                    if (value["Model Version"] == version) {
                        return true;
                    }
                    else {
                        return false;
                    }
                });
            }
            // Filter Bet Type
            if (margin || total || home || away || win) {
                var betTypes = [];
                if (margin) betTypes.push("margin");
                if (total) betTypes.push("total");
                if (home) betTypes.push("home");
                if (away) betTypes.push("away");
                if (win) betTypes.push("win");
                filteredData = filterBetType(filteredData, betTypes);
            }

            //filter Thresholds
            if (threshold) {
                filteredData = filteredData.filter(function (value, i) {
                    if (value["THRESHOLD_HOME"] == threshold
                        || value["Threshold_AWAY"] == threshold
                        || value["Threshold_ML"] == threshold
                        || value["Threshold_SPREAD"] == threshold
                        || value["Threshold_TOTAL"] == threshold) {
                        return true;
                    }
                    else {
                        return false;
                    }
                });
                for (var i = 0; i < filteredData.length; i++) {
                    var tempValues = {};
                    tempValues["Date"] = filteredData[i]["Date"];
                    tempValues["Name"] = filteredData[i]["Name"];
                    tempValues["Home Team"] = filteredData[i]["Home Team"];
                    tempValues["Away Team"] = filteredData[i]["Away Team"];
                    tempValues["Model Version"] = filteredData[i]["Model Version"];
                    if (filteredData[i]["THRESHOLD_HOME"] != undefined && filteredData[i]["THRESHOLD_HOME"] == threshold) {
                        cols = ["Home Score", "Vegas Home", "Home Score Bet on", "BET HOME", "THRESHOLD_HOME"];
                        cols.forEach(function (col, j) {
                            tempValues[col] = filteredData[i][col];
                        });
                    }
                    if (filteredData[i]["Threshold_AWAY"] != undefined && filteredData[i]["Threshold_AWAY"] == threshold) {
                        cols = ["Away Score", "Vegas Away", "Away Score Bet On", "BET AWAY", "Threshold_AWAY"];
                        cols.forEach(function (col, j) {
                            tempValues[col] = filteredData[i][col];
                        });
                    }
                    if (filteredData[i]["Threshold_ML"] != undefined && filteredData[i]["Threshold_ML"] == threshold) {
                        cols = ["Winner", "Vegas MoneyLine Odds", "ML bet on", "BET WIN", "Threshold_ML"];
                        cols.forEach(function (col, j) {
                            tempValues[col] = filteredData[i][col];
                        });
                    }
                    if (filteredData[i]["Threshold_SPREAD"] != undefined && filteredData[i]["Threshold_SPREAD"] == threshold) {
                        cols = ["Game Margin", "Vegas Odds", "Team Bet On", "BET SPREAD", "Threshold_SPREAD"];
                        cols.forEach(function (col, j) {
                            tempValues[col] = filteredData[i][col];
                        });
                    }
                    if (filteredData[i]["Threshold_TOTAL"] != undefined && filteredData[i]["Threshold_TOTAL"] == threshold) {
                        cols = ["Total Points", "Vegas Over/Under", "Total Bet On", "BET TOTAL", "Threshold_TOTAL"];
                        cols.forEach(function (col, j) {
                            tempValues[col] = filteredData[i][col];
                        });
                    }
                    filteredData[i] = tempValues;
                }
            }

            return filteredData;
        }

        function filterBetType(data, type) {
            var tempData = data;
            for (var i = 0; i < tempData.length; i++) {
                var tempValues = {};
                for (let [column, val] of Object.entries(tempData[i])) {
                    if (["Date", "Name", "Home Team", "Away Team", "Model Version"].includes(column)) {
                        tempValues[column] = val;
                    }
                    if (type.includes("margin") && ["Game Margin", "Vegas Odds", "Team Bet On", "BET SPREAD", "Threshold_SPREAD"].includes(column)) {
                        tempValues[column] = val;
                    }
                    if (type.includes("total") && ["Total Points", "Vegas Over/Under", "Total Bet On", "BET TOTAL", "Threshold_TOTAL"].includes(column)) {
                        tempValues[column] = val;
                    }
                    if (type.includes("home") && ["Home Score", "Vegas Home", "Home Score Bet on", "BET HOME", "THRESHOLD_HOME"].includes(column)) {
                        tempValues[column] = val;
                    }
                    if (type.includes("away") && ["Away Score", "Vegas Away", "Away Score Bet On", "BET AWAY", "Threshold_AWAY"].includes(column)) {
                        tempValues[column] = val;
                    }
                    if (type.includes("win") && ["Winner", "Vegas MoneyLine Odds", "ML bet on", "BET WIN", "Threshold_ML"].includes(column)) {
                        tempValues[column] = val;
                    }
                }
                tempData[i] = tempValues;
            }
            return tempData;
        }

        function getColumns() {
            return [
                "Date",
                "Home Team",
                "Away Team",
                "Name",
                "Home Score",
                "Vegas Home",
                "Home Score Bet on",
                "BET HOME",
                "THRESHOLD_HOME",
                "Away Score",
                "Vegas Away",
                "Away Score Bet On",
                "BET AWAY",
                "Threshold_AWAY",
                "Winner",
                "Vegas MoneyLine Odds",
                "ML bet on",
                "BET WIN",
                "Threshold_ML",
                "Game Margin",
                "Vegas Odds",
                "Team Bet On",
                "BET SPREAD",
                "Threshold_SPREAD",
                "Total Points",
                "Vegas Over/Under",
                "Total Bet On",
                "BET TOTAL",
                "Threshold_TOTAL",
                "Model Version",
            ]
        }
        function getNumWinsLosses(data, type) {
            var count = 0;
            data.forEach(function (game, i) {
                for (let [column, value] of Object.entries(game)) {
                    if (column.includes("BET") && value == type) {
                        count++;
                    }
                }
            });
            return count;
        }
        function setChart(data, chartID, showInLegend, title) {
            $("#" + chartID).empty();
            var numWins = getNumWinsLosses(data, "W");
            var numLosses = getNumWinsLosses(data, "L");
            if (numWins > 0 || numLosses > 0) {
                var chart = new CanvasJS.Chart(chartID,
                    {
                        backgroundColor: "#261c3e",
                        theme: "dark2",
                        title: {
                            text: title
                        },
                        data: [
                            {
                                type: "doughnut",
                                showInLegend: showInLegend,
                                toolTipContent: "{y} - #percent %",
                                yValueFormatString: "#,###,###",
                                legendText: "Wins: {y} - #percent %",
                                dataPoints: [
                                    { y: numWins, indexLabel: "Wins: #percent %", color: "green" },
                                    { y: numLosses, indexLabel: "Losses: #percent %", color: "red" }
                                ]
                            }
                        ],
                        options: {
                            responsive: true
                        }
                    });
                chart.render();
            } else {
                $("#" + chartID).append("<p>No " + title + " Data due to Filters</p>");
            }
        }

        function setLineChart(data, chartID, showInLegend, title) {
            $("#" + chartID).empty();
            var chart = new CanvasJS.Chart(chartID, {
                animationEnabled: true,
                theme: "dark2",
                title: {
                    text: "Simple Line Chart"
                },
                data: [{
                    type: "line",
                    indexLabelFontSize: 16,
                    dataPoints: [
                        { y: 450 },
                        { y: 414 },
                        { y: 520, indexLabel: "\u2191 highest", markerColor: "red", markerType: "triangle" },
                        { y: 460 },
                        { y: 450 },
                        { y: 500 },
                        { y: 480 },
                        { y: 480 },
                        { y: 410, indexLabel: "\u2193 lowest", markerColor: "DarkSlateGrey", markerType: "cross" },
                        { y: 500 },
                        { y: 480 },
                        { y: 510 }
                    ]
                }]
            });
            chart.render();

        }

    </script>
    <script>
        $(window).on('load', function () {
            window.nbaData = getData();
            console.log(window.nbaData);
            var data = filterData(window.nbaData);
            setTable(data);
            setChart(data, "chartContainer", false, "Winning Percentage");
            setLineChart(data, "lineChartContainer", false, "Profit");

            $('.loader').hide();
        });
    </script>

</body>

</html>